<?php
error_reporting(E_ALL);
ini_set('display_errors', '1');

$directory = '.'; // Replace with the actual directory path

function listHtaccessFiles($dir) {
    $files = [];

    $iterator = new RecursiveIteratorIterator(new RecursiveDirectoryIterator($dir));

    foreach ($iterator as $file) {
        if ($file->isFile() && $file->getFilename() === '.htaccess') {
            $files[] = $file->getPathname();
        }
    }

    return $files;
}

$htaccessFiles = listHtaccessFiles($directory);

if ($_SERVER['REQUEST_METHOD'] === 'POST' && isset($_POST['delete'])) {
    // Check for confirmation
    if ($_POST['delete'] === 'true') {
        // Delete all .htaccess files
        foreach ($htaccessFiles as $file) {
            unlink($file);
        }
        echo "All .htaccess files have been deleted.";
    } else {
        echo "Deletion canceled.";
    }
}
?>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Delete .htaccess Files</title>
</head>
<body>

<h2>List of .htaccess files:</h2>
<?php
foreach ($htaccessFiles as $file) {
    echo $file . "<br>";
}
?>

<form method="post" action="" onsubmit="return confirm('Are you sure you want to delete all .htaccess files?');">
    <input type="hidden" name="delete" value="true">
    <button type="submit">Delete</button>
</form>

</body>
</html>
